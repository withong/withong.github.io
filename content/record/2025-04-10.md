+++
title = "JWT란?"
date = "2025-04-10T22:00:06+09:00"
draft = false
tag = ["내일배움캠프", "과제", "일정 관리 API", "JWT", "TIL"]
+++

<hr>
<br>

## 1. JWT 정의

JWT는 **JSON Web Token**의 약자로, **JSON** 형식의 데이터를 **안전하게 전송**하기 위한 표준이다. 이 표준은 **인터넷 상에서의 인증 및 권한 부여**와 관련된 시스템에서 주로 사용된다. 예를 들어, 사용자가 서버에 로그인하면 서버는 JWT를 생성하여 사용자에게 제공하고, 사용자는 이 JWT를 통해 인증을 유지할 수 있다.  

JWT는 본질적으로 **세션 관리 방식**을 대체할 수 있다. 전통적인 세션 방식은 서버에 상태를 저장하고 세션 ID를 클라이언트에게 전달하는 방식이지만, JWT는 **서버에 상태를 저장하지 않는** 방식을 채택하여 **세션리스** 인증 방식을 가능하게 한다.

<br>
<hr>
<br>

## 2. JWT의 구조

JWT는 크게 3부분으로 나누어져 있다: **헤더(Header)**, **페이로드(Payload)**, **서명(Signature)**

### 2.1 헤더 (Header)

헤더는 토큰의 **메타데이터**를 담고 있다:  

- **typ (type)** : 토큰의 유형을 나타낸다. JWT에서는 항상 `JWT`
- **alg (algorithm)** : 사용된 서명 알고리즘을 나타낸다.  
  `HS256`(HMAC SHA-256), `RS256`(RSA SHA-256)와 같은 알고리즘  

**헤더의 예시**:  
```json
{
  "typ": "JWT",
  "alg": "HS256"
}
```

<br>

### 2.2 페이로드 (Payload)

페이로드는 실제 토큰에 담길 **정보**를 포함하는 부분이다. 이 정보를 **클레임(Claim)** 이라고 하며, JWT에서 사용되는 **주요 정보**이다. 클레임은 크게 **등록된 클레임(Registered Claims)**, **공개 클레임(Public Claims)**, **비공개 클레임(Private Claims)** 으로 구분된다.

- **등록된 클레임(Registered Claims)** :  
  JWT 표준에서 정의한 일부 예약된 이름을 가진 클레임 (예: `iss`, `exp`, `sub`, `iat` 등)
- **공개 클레임(Public Claims)** :  
  자유롭게 정의할 수 있는 클레임 (예: `userId`, `username`, `roles` 등)
- **비공개 클레임(Private Claims)** :  
  두 당사자 간에만 사용하는 클레임 (예: 비즈니스 로직에 맞춘 특정 데이터)

**페이로드 예시**:
```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": 1516239022
}
```

<br>

### 2.3 서명 (Signature)

서명은 JWT의 무결성을 보장하고, JWT가 변조되지 않았음을 확인하는 데 사용된다.  

서명 생성 방식:  
1. **헤더**와 **페이로드**를 Base64Url로 인코딩
2. 인코딩된 헤더와 페이로드를 결합하고 비밀 키와 함께 서명 알고리즘을 사용하여 서명 생성

서명 생성 과정:  
```
HMACSHA256(
  base64UrlEncode(header) + "." + base64UrlEncode(payload),
  secret)
```

서명은 JWT의 마지막 부분에 위치하며, 이를 통해 JWT의 유효성을 검증할 수 있다.

<br>
<hr>
<br>

## 3. JWT 사용 목적

### 3.1 인증 (Authentication)
JWT는 **사용자 인증**에 매우 널리 사용된다. 사용자가 로그인하면 서버는 JWT를 생성하여 클라이언트에게 전달하고, 이후 클라이언트는 이 JWT를 서버로 다시 보내 인증을 요청한다. 서버는 토큰을 검증하여 사용자가 인증되었는지 확인하고, 인증된 요청에 대해서만 응답한다.

### 3.2 권한 부여 (Authorization)
JWT는 인증된 사용자가 **어떤 자원에 접근할 수 있는지** 권한 정보를 포함할 수 있다. 예를 들어, JWT에 `roles`라는 클레임을 추가하고, 서버는 이를 기반으로 사용자가 접근할 수 있는 자원을 결정한다.

### 3.3 정보 교환 (Information Exchange)
JWT는 **서버 간 정보 교환**에도 유용하다. 토큰은 서명되어 있어 변조를 방지할 수 있기 때문에, 안전한 데이터 전송을 보장한다. 예를 들어, 서로 다른 서버들 간에 사용자 정보를 안전하게 교환할 수 있다.

<br>
<hr>
<br>

## 4. JWT의 장점

### 4.1 자가 포함적 (Stateless)
JWT는 **서버에 상태를 저장하지 않는다**. 클라이언트가 JWT를 서버로 전송하면, 서버는 이 JWT만을 이용하여 사용자 인증을 처리할 수 있다. 서버는 세션 정보를 저장할 필요가 없고 **확장성**에 유리하다.

### 4.2 확장성
서버 간의 분산 환경에서 JWT는 매우 유리하다. 서버가 여러 대일 경우에도 각 서버는 JWT만 있으면 사용자를 인증할 수 있으므로 서버 간 상태를 공유할 필요가 없다.

### 4.3 보안
JWT는 서명되어 있어 데이터의 **변조**를 방지할 수 있다. 또한, 필요시 **암호화**하여 데이터의 기밀성을 보호할 수 있다.

### 4.4 효율성
JWT는 일반적으로 **작은 크기**로 만들어져 네트워크 효율성을 높여준다. 또한, 서버에서 세션 정보를 저장할 필요가 없으므로 **메모리**와 **저장소**를 절약할 수 있다.

<br>
<hr>
<br>

## 5. JWT 사용 시 고려사항

### 5.1 토큰 만료 (Expiration)
JWT는 **만료 시간을 설정**할 수 있다. 만약 토큰이 만료되면, 사용자는 다시 로그인해야 한다. 이를 `exp` 클레임을 통해 설정할 수 있다. 이 클레임은 토큰의 만료 시간을 나타내며, 클라이언트가 유효한 토큰을 계속 사용할 수 있도록 한다.

### 5.2 토큰 저장
JWT를 저장하는 위치도 중요하다. **로컬 스토리지(localStorage)**에 저장하면 **XSS 공격**에 취약해질 수 있다. 보안상 **세션 스토리지(sessionStorage)**나 **HTTP-only 쿠키**에 저장하는 것이 더 안전할 수 있다.

### 5.3 비밀 키 관리
JWT의 **비밀 키**는 매우 중요하다. 비밀 키가 유출되면, 누구든지 토큰을 위조할 수 있기 때문에 안전하게 관리해야 한다. 이를 **환경 변수**나 **암호화된 저장소**에서 관리하는 것이 좋다.

<br>
<hr>
<br>

## 6. JWT 토큰 생성 및 검증 방법

### 6.1 토큰 생성 (발급)
JWT는 보통 사용자가 로그인한 후, 서버에서 사용자 정보를 기반으로 토큰을 생성한다. 예를 들어, 사용자의 아이디나 권한 정보 등을 페이로드에 포함시켜 토큰을 만든다.

### 6.2 토큰 검증
JWT가 클라이언트로부터 전달되면, 서버는 이 토큰을 **서명**을 통해 검증한다. 만약 서명이 유효하고 토큰이 만료되지 않았다면 서버는 해당 요청을 인증된 사용자로 처리한다.

<br>
<hr>
<br>

## 7. JWT와 관련된 보안 고려사항

- **SSL/TLS 사용**:  
   JWT는 HTTP를 통해 전송되므로 **SSL/TLS**를 사용하여 **중간자 공격(MITM)** 을 방지한다.
- **만료된 토큰 처리**:  
   JWT 토큰이 만료되면 **리프레시 토큰**을 사용하여 새로운 토큰을 발급할 수 있다.
- **클레임 조작 방지**:  
   중요한 데이터는 JWT에 담지 말고 서버에서 안전하게 관리해야 한다.

<br>
<hr>